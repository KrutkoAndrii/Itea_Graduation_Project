Программа для работы стоварами

1. Общие сведения
2. Структура программы
    2.1 Структура данных
	2.2 Файлы, пакеты и модули программы
		2.2.1 db.ini
		2.2.2 base.sql
		2.2.3 Пакет database
		   2.2.3.1  Модуль db_tools.py
		   2.2.3.2  Модуль  users_tools.py
		2.2.4 Пакет  visualisation
		   2.2.4.1 Модуль mframe.py 
		   2.2.4.2 Модуль  logining.py
		   2.2.4.3 Модуль add_users.py 
		   2.2.4.4 Модуль main_form.py
		   2.2.4.5 Модуль add_properties.py
		   2.2.4.6 Модуль show_all_users.py
		   2.2.4.7 Модуль add_goods.py
		2.24 Модуль main.py 
		
3. Работа с программой

1. Общие сведения

	Программа предназначена для ведения каталога товаров с возможностью 
	учитывать дополнительные свойства товара. Программа позволяет разделить 
	права доступа к данным на уровне ролей пользователей заложенных на уровне
	 системы:
	    1)SuperAdmin - роль пользователей которые могут создавать новых 
	    пользователей системы, блокировать пользователей, а также работать со
	     всеми сущностями программы.
	    2) Admin  - роль пользователей которые могут работать со всеми 
	    сущьностями программы в полном объеме, но не могут создавать новых 
	    пользователей.
	    3) User -  роль пользователей которые могут просматривать все 
	    сущьности программы, но не могут их изменять и удалять. Также данной 
	    роли запрещено создание новых пользователей.

    Программмма является клиентским приложением для доступа к данным которые
      хнанятся на сервере баз данных PostgreSQL. Совместимость программы с 
      PostgreSQL начиная с версии 9.0. Для нормального функционирования в 
      системе должны быть предустановлены пакеты PyQt5, psycopg2 которые не 
      входят в стандартную поставку Python  и должны быть предустановлены до 
      начала работы программы( например при помощи pep).

2. Структура программы

    Код программы разбит согласно требований к реализации финального задания: 
    на основной модуль программы и на 2 пакета которые объеденены по смыслу 
    реализуемых в них функций. Данные программы хранятся на сервере баз данных
    PostgreSQL в таблицах согласно их назначению.
    
2.2 Структура данных
        
        Для хранения данных на сервере баз данных PostgreSQL созданы 3 
        траблицы:
        1) Color - Являтся справочником цветов для товаров. Имеет следующие 
            поля: 
             id (int) -  primary key  таблицы
	         name varchar(20) - название цвета товара 
	
        3) Goods - Основная таблица в которой сохраняются основніе данніе о 
        товаре. Имеет следующие поля:
        id (int) - 	primary key таблицы
	    name varchar(35) - название товара
	    color (int) - foring key  для связи стаблицей  color,
	    density (float) - значение плотности г/м3 ,
	    width (int) - ширина товара 
        
        2) Attributes - Хранит дополнительные свойства товара, предназначена 
        для введения новых свойств товара если их не хватает в основной 
        таблице Goods.Имеет следующие поля:
        id (int) - 	primary key таблицы
        name varchar(20) - название дополнительного атрибута,
	    value (int) - значение дополнительного парамиетра,
	    goods int) - foring key  для связи стаблицей  Goods. имеет каскадную 
	    связь - при удалении основной сущьности производится автоматическое 
	    удаление всех дополнительных атрибутов данной сущности.
	    
2.2 Файлы, пакеты и модули программы
      
    В поставляемый состав программы входит основной модуль main.py и 2 
    пакета: database,visualisation. В пакете database собраны все функции по 
    взаимодействию с базой данных PostgreSQL. В пакет visualisation вошли все
    классы и функции отвечающие за работу пользовательского интерфейса 
    программы. Так же в общий комплекс входят 2 допольнительных файла db.ini
	и base.sql.
	
2.2.1 db.ini

    Предназначен для хранения первоначальной информации для подключения к 
    PostgreSQL. имеет следующие параметры:
    db_name = things - название рабочей базы данных. всегда должно оставаться
     с таким значением.
    db_user = postgres - основной пользователь базданных с правами на 
    создание базданных в PostgreSQL и ввода новых ролей.
    db_password = fortuna - пароль пользователя  
    db_location = localhost  - сетевой адрес PostgreSQL
    
 2.2.2  base.sql
 
    В данном файле хранится скрипт при помощи которого создается основная 
    база данных в случае отсутствия таковой на сервере базданных. Так же 
    скрипт создает первого пользователя базы данных root  с предустановленым 
    паролем root. Данный пользователь обладает всем правами в системе и может
    создавать новых пользователей а так же блокировать их работу в системе.
    
2.2.3 Пакет database

    Данный пакет содержит все функции для взаимодействия с базой данных 
    PostgreSQL.

2.2.3.1 модуль db_tools.py

    содержит функции по подключению к базе данных PostgreSQL, совершению 
    транзакций, проверке соединения. Далее приводится перечень функций пакета
     с их входными/выходными параметрами
   
     get_ini_file() - функция предназначена для получения первоначальных данных
     подключения к базе данных с файла db.ini. у функции нет входящих 
     параметров. в процессе работы функция возвращает следующие значения:
      db_name = things - название рабочей базы данных. всегда должно оставаться
      с таким значением.
     db_user = postgres - основной пользователь базданных с правами на 
     создание базданных в PostgreSQL и ввода новых ролей.
     db_password = fortuna - пароль пользователя  
     db_location = localhost  - сетевой адрес PostgreSQL
     
     is_check_db_instance(dbase, user_in, password_in, server) - функция 
     проверки наличия базы данных things  на сервере PostgreSQL. входніми 
     параметрами функции есть
        dbase - название проверяемой базы данных
        user_in - пользователь базы данных
        password_in - пароль пользователя базы данных
        server - сетевой адрес сервера PostgreSQL
      функция возвращает True/False в случае наличия или отсутствия базі 
      данніх на сервере.
      
      create_db(dbase, user_in, password_in, server) - Данная функция 
      предназначена для создания базы данных things  на сервере баз данніх в 
      случае отсутствия таковой. Входными параметрами есть:
        dbase - название проверяемой базы данных
        user_in - пользователь базы данных
        password_in - пароль пользователя базы данных
        server - сетевой адрес сервера PostgreSQL
      Данная функция берет скрипты с файла base.sql. Функция не имеет 
      выходных данных.
      
      connect_to_db(dbase, user_in, password_in, server) - Функция 
      предназначена для создания соединения с базой данных. Входными 
      параметрами есть:
        dbase - название проверяемой базы данных
        user_in - пользователь базы данных
        password_in - пароль пользователя базы данных
        server - сетевой адрес сервера PostgreSQL 
      Функция возвращает курсор на соединение с базой данных.
      
      sql_result(conn, sql_text) - Функция предназначена для выполнения 
      запросов типа SELECT.  Входными параметрами функции есть курсор 
      соединения с базой данных и строка, содержащая сам запрос(SQL). в 
      качестве выходного параметра выступает таблица результата выполнения 
      запроса к базе данных.   
      
      is_sql_no_result(conn, sql_text) - Функция предназначена для выполнения 
      запросов типа INSERT/UPDATE/DELETE. Входными параметрами функции есть 
      курсор соединения с базой данных и строка, содержащая сам запрос(SQL).
      Функция возвращает True/False в случае удачного/неудачного выполнения 
      запроса к базе данных.  
      
2.2.3.2 Модуль  users_tools.py

    В данном модуле собрані все функции по проверке/созданию 
    пользователей на сервере баз данных. Данный модуль содержит следующие 
    функции:
    is_check_db_password(dbase, user_in, password_in, server) - Функция 
    предназначена для первоначальной авторизации пользователя в программе. 
    Входными парметрами есть:
        dbase - название проверяемой базы данных
        user_in - пользователь базы данных
        password_in - пароль пользователя базы данных
        server - сетевой адрес сервера PostgreSQL 
    В случае удачной авторизации функция возвращает True,  вс лучае отказ в 
    доступе к базе данных функция возвращает False.
    
    is_add_user(conn, user_in, password_in, role) - Функция предназначена для
    создания нового пользователя программы администратором(с правами 
    SuperAdmin). Входными параметрами функции есть:
        conn - курсор на соединение с базой данных,
        user_in - имя нового пользователя программы,
        password_in - пароль пользователя, 
        role - роль пользователя.
        
2.2.4 Пакет  visualisation
    
    В данном пакете собраны классы/функции для работы с интерфейсом 
    пользователя. 
    
2.2.4.1 Модуль mframe.py 

     Содержит в себе класс Ui_MainWindow основной формы приложения.
     Никаких дополнительных функций не содержит, Предназначен для импорта в 
     основной модуль приложения.
 
2.2.4.2 Модуль  logining.py

    Содержит основной класс формы для первоначальной авторизации пользователя
    в программе class LoginUser. Содержит функцию push_login которая 
    формирует запрос к базе данных для проверки разрешения доступа 
    пользователя в программу. 
     
2.2.4.3 Модуль add_users.py
    
    Содержит класс формы для создания администратором новых пользователей 
    программы class CreateUser. Функция push_create формирует запрос к базе 
    данных на создание нового пользователя на основании введенных данных и, 
    согласно прав пользователя под которым происходит создание нового 
    пользователя возвращает сообщение об подтверждении или отказе создания 
    новго пользователя в зависимости от прав.
    
2.2.4.4  Модуль main_form.py

    Содержит основной клас формы class TheMainForm который наследует 
    Ui_MainWindow и расширяет его функционал. Это предназначено для 
    безболезненного изменения визуальной части интерфейса пользователя.
    Класс содержит следующие функции:
    filter_goods - Выставляет параметры и фильтрует данные по выбранному 
    пользователем параметру.
    update_item - Вызывает форму для изменений свойств товара.
    add_color - добавляет новый цвет в справочник цветов товара.
    del_attribut - удаляет атрибут товара.
    add_attribute - добавляет атрибут товара.
    renew_attributes - обновляет табличную часть атрибутов товара.
    del_item - удаляет товар из тоаблицы товаров.
    clickedRowColumn - по нажатию на табличной части товаров переносит 
    значение из выбранной ячейки в поле фильтра для дальнейшей возможности 
    фильтрации по данному свойству (из выделенного столбща)
    add_item - добавляет новый товар в таблицу товаров
    show_all_user - показывает форму интерфейса с перечнем всех пользователей
     программы для возможности блокирования/разблокирования пользователя.
    renew_item - формирует запрос на обновление товаров в табличной части 
    товаров.
    create_user - открывает форму для добавления новго пользователя программы.

2.2.4.5 Модуль add_properties.py

    Содержит в себе классы форм для добавления новых свойств товаров.
    class AddColor - предназначен для отображения формы мсоздания новых 
    цветов товара в таблице цветов.
    class AddAttribute - предназначен для отображения формы создания новых 
    атрибутов товара.
    
    class AddColor содержит в себе функцию push_create которая формирует 
    запрос к базе данных на добавление новой записи в таблицу Color.
    
    class AddAttribute содержит в себе функцию push_create которая формирует 
    запрос к базе данных на создание записи в таблице Attributes.
    
2.2.4.6 Модуль show_all_users.py

    Содержит в себе  class ShowUsers предназначеный для отображения формы 
    списка пользователей программы с возможностью выбора для блокирования / 
    разблокирования доступа в программу. содержит следующие функции:
    draw_table - функция заполняет значениями табличную часть формы, формируя
     запрос к таблице пользователей базы данных pg_catalog.pg_roles
    ban- функция блокирует доступ к программе пользователю который был 
    выбран из табличной части.
    renew- функция возобновляет права доступа к программе выбранному
    пользователю.
    
2.2.4.7 Модуль add_goods.py

    Содержит в себе class AddItem отвечающий за форму 
    добавления/редактирования товаров. Содержит следующие функции
    select_item - выбирает данные из базы данных и заполняет соответствующие 
    поля в случае вызова формы на редактирование товара
    push_create - в зависимости от вызова (добавление/редактирование) 
    произодит добавление в таблицу товаров Goods или редактирует уже 
    имеющуюся запись в таблице.
    
2.2.5 Модуль main.py

    Является основным модулем приложения из которого происходит обращение ко 
    всем остальным модулям. Содержит class Message с двумя процедурами 
    is_chose_message - для вывода сообщения с возможностью выбора и возвратом
     варианта выбора пользователя
    message_oк - окно сервисного сообщения сообщения об уведомлении 
    пользователя о завершении какой-либо операции
    обе функции имеют входные параметры
    title - заголовок выводимого окна,
    messagе - текст сообщения который будет выведен пользователю. 
    Так же модуль имеет процедуру main осуществляющую запуск основного 
    функционала программы.
    
3. Работа с програмой

    При первом старте программа проверяет если доступ к серверу баз данных и 
    зарегистрирована ли основная база приложения things. В случае если нет 
    доступа к серверу программа выдаст соответствующее сообщение и закончит 
    работу. Если же доступ есть, но основная база приложения остутствует, то 
    программа предложит создать ее. Если проверки прошли удачно и база данных
    была найдена на сервере, программа выведет приглашение пользователю 
    авторизироваться в программе. После авторизации пользователю будет 
    выведено основное окно приложения с доступом к общему функционалу. Для 
    всех пользователй (с любой ролью доступа) выводится одинаковый интерфейс 
    - права на исполнение тех или иных функций определяются на уровне прав 
    пользователя зарегистрированного на сервере баз данных. Если у 
    пользователя нет прав, например, на добавление новых пользователей, то 
    при попытке создания новых пользователей такому пользователю будет выданно 
    сообщение об отсутствии на данные действия прав.
        Согласно прав доступа, пользователи могут осуществлять в программе 
     добавление новых пользователей, добавление нового товара, заполнение 
     справочника цветов товара, добавление товару новых атрибутов. 
     
    
     
     

        
            
             
    
      